\documentclass[../electromagnetism.tex]{subfiles}
\begin{document}
\section{The Wave Equation}
Maxwell's equations are of utmost importance in studying the behavior of electromagnetic field, due to their versatility and generality. It's due to Maxwell himself that we now treat light as electromagnetic radiation, particularly, electromagnetic waves.
The reasoning behind Maxwell's work comes \textit{directly} from his equation. Consider a location of space in which there are no charges nor currents, i.e. no \textit{sources}. For such system, Maxwell's equations are\footnote{From now on, here we will use the standard boldface vector notation for ease of reading. Index notation will be used in the chapter on crystals and in some other section}
\begin{equation}
	\left\{ \begin{aligned}
			\nabla\times\vec{E}&=-\pdv{\vec{B}}{t}\\
			\nabla\times\vec{B}&=\frac{1}{c^2}\pdv{\vec{E}}{t}
	\end{aligned}\right.
	\label{eq:mweq.waves}
\end{equation}
Where, the divergence equations are both equally zero
\begin{equation}
	\nabla\cdot\vec{E}=\nabla\cdot\vec{B}=0
	\label{eq:diveq.waves}
\end{equation}
It's important to remember that 
\begin{equation*}
	c^2=\frac{1}{\mu_0\epsilon_0}
\end{equation*}
Is the ``\textit{speed of light}'' for reasons that will be clear after a couple of manipulations. For reasons of symmetry of the two curl equations we use the following substitution
\begin{equation}
	\vec{B}=\mu_0\vec{H}
	\label{eq:btoh.waves}
\end{equation}
for which, the only nonzero equations are
\begin{equation}
	\left\{\begin{aligned}
		\nabla\times\vec{E}&=-\mu_0\pdv{\vec{H}}{t}\\
		\nabla\times\vec{H}&=\epsilon_0\pdv{\vec{E}}{t}
	\end{aligned}\right.
	\label{eq:nonzeromwe.waves}
\end{equation}
The main problem of these equations is that they're still coupled between eachother, and there are still the previous divergence equations, but this can be solved quickly. Remembering the following operator identity
\begin{equation*}
	\nabla\times\nabla\times[\quad]=\nabla\left(\nabla\cdot[\quad]\right)-\nabla^2[\quad]
\end{equation*}
We get, by taking the curl of both equations, and reinserting them to the right hand side
\begin{equation}
\left\{	\begin{aligned}
		\nabla\times\nabla\times\vec{E}&=-\mu_0\epsilon_0\pdv[2]{\vec{E}}{t}\\
		\nabla\times\nabla\times\vec{H}&=-\mu_0\epsilon_0\pdv[2]{\vec{H}}{t}
	\end{aligned}\right.
	\label{eq:nablanabla.waves}
\end{equation}
Or, inserting the identity and \eqref{eq:diveq.waves}
\begin{equation}
	\left\{\begin{aligned}
			\nabla^2\vec{E}&=\frac{1}{c^2}\pdv[2]{\vec{E}}{t}\\
			\nabla^2\vec{H}&=\frac{1}{c^2}\pdv[2]{\vec{H}}{t}
	\end{aligned}\right.
	\label{eq:waveeq.waves}
\end{equation}
Or, more compactly
\begin{equation}
	\left\{ \begin{aligned}
			\square\vec{E}&=0\\
			\square\vec{H}&=0
	\end{aligned}\right.
	\label{eq:square.waves}
\end{equation}
Where
\begin{equation}
	\square=\frac{1}{c^2}\pdv[2]{t}-\nabla^2
	\label{eq:dalambertian.waves}
\end{equation}
Is known as the \textit{D'Alembertian} operator. The equation we wrote is a wave equation for waves traveling at $v=c$.
\subsection{Dielectric Wave Equation}
If we consider now ourselves inside some media, we have to take account of both \textit{polarization} and \textit{magnetization}, given by the presence of atoms inside the medium. These atoms will absorb some special frequencies, which will be known as \textit{resonance frequencies}.\\
Far from the resonant frequencies, the medium is known as a transparent and non-absorbent medium. Maxwell's equations are the usual complete ones:
\begin{equation}
	\left\{ \begin{aligned}
			\nabla\cdot\vec{E}&= \frac{\rho}{\epsilon_0}\\
			\nabla\times\vec{E}&= -\pdv{\vec{B}}{t}\\
			\nabla\cdot\vec{B}&= 0\\
			\nabla\times\vec{B}&= \mu_0\vec{J}+\mu_0\epsilon_0\pdv{\vec{E}}{t}
	\end{aligned}\right.
	\label{eq:mwgeneralmedia}
\end{equation}
Consider now a real electromagnetic wave, it will be composed of multiple frequencies, denoted with $\omega$. An electromagnetic wave will be denoted as \textit{monochromatic} if and only if it's composed by a single frequency, (note that in nature there are no monochromatic waves). In this ideal case, the electric field is:
\begin{equation}
	\vec{E}(\vec{r},t)=\vec{E}_\omega(\vec{r})e^{-i\omega t}
	\label{eq:frequencydec.waves}
\end{equation}
With the exponential coming from the wave equation itself.\\
Since we are dealing with dielectrics, we gotta consider charge polarization $\vec{P}$, which will also be decomposed in frequencies, therefore, inserting the $D$ field in our calculations
\begin{equation}
	\vec{D}_\omega=\epsilon_0\vec{E}_\omega+\vec{P}_\omega=\epsilon_\omega\vec{E}_\omega
	\label{eq:dvector.waves}
\end{equation}
Where we used the following two relations
\begin{equation}
	\left\{\begin{aligned}
			\vec{P}_\omega&= \epsilon_0\chi_\omega\vec{E}_\omega\\
			\epsilon_\omega&= \epsilon_0(1+\chi_\omega)
	\end{aligned}\right.
	\label{eq:dtoe.waves}
\end{equation}
Noting that here, in general, $\epsilon_\omega$ depends on position, the first Maxwell equation for dielectrics becomes slightly more complicated
\begin{equation*}
	\nabla\cdot\vec{D}_\omega=\vec{E}_\omega\cdot\nabla\epsilon_\omega+\epsilon_\omega\nabla\cdot\vec{E}_\omega=0
\end{equation*}
Solving for $E_\omega$ we get
\begin{equation}
	\nabla\cdot\vec{E}_\omega=-\frac{\vec{E}_\omega\cdot\nabla\epsilon_\omega}{\epsilon_\omega}
	\label{eq:gaussdie.waves}
\end{equation}
Evaluating the time derivatives for the monochromatic fields we have
\begin{equation*}
	\begin{aligned}
		\pdv{\vec{E}}{t}&= -i\omega\vec{E}\\
		\pdv{\vec{H}}{t}&= -i\omega\vec{H}
	\end{aligned}
\end{equation*}
Inserting everything into Maxwell's equations we get the set of equations for monochromatic waves in general non-magnetic media
\begin{equation}
	\left\{\begin{aligned}
			\nabla\cdot\vec{E}_\omega&= -\frac{\vec{E}_\omega\cdot\nabla\epsilon_\omega}{\epsilon_\omega}\\
			\nabla\times\vec{E}_\omega&= i\omega\mu_0\vec{H}_\omega\\
			\nabla\cdot\vec{H}_\omega&= 0\\
			\nabla\times\vec{H}_\omega&= -i\omega\epsilon_\omega\vec{E}_\omega
	\end{aligned}\right.
	\label{eq:mweqdie.waves}
\end{equation}
Now, using the same technique we used before for finding the wave equation, we get
\begin{equation*}
	\begin{aligned}
		\nabla\times\nabla\times\vec{E}_\omega&= -\omega^2\mu_0\epsilon_\omega\vec{E}_\omega\\
		\nabla\times\nabla\times\vec{H}_\omega&= -\omega^2\mu_0\epsilon_\omega\vec{H}_\omega
	\end{aligned}
\end{equation*}
Therefore, inserting the divergence equations and taking care of the minus signs
\begin{equation*}
	\begin{aligned}
		\nabla^2\vec{E}_\omega+\nabla\left( \frac{\vec{E}_\omega\cdot\nabla\epsilon_\omega}{\epsilon_\omega} \right)&= \omega^2\mu_0\epsilon_\omega\vec{E}_\omega\\
		\nabla^2\vec{H}_\omega&= \omega^2\mu_0\epsilon_\omega\vec{H}_\omega
	\end{aligned}
\end{equation*}
\begin{dfn}[Refraction Index]
	We define the \textit{refraction index} $n_\omega$ as follows
	\begin{equation}
		n_\omega(\vec{r})=\sqrt{\frac{\epsilon_\omega(\vec{r})}{\epsilon_0}}
		\label{eq:refractionind.waves}
	\end{equation}
	Hence
	\begin{equation*}
		\epsilon_\omega=\epsilon_0n_\omega^2
	\end{equation*}
\end{dfn}
Inserting the previous definition into the divergence of $E_\omega$ we see that
\begin{equation*}
	\frac{\vec{E}_\omega\cdot\nabla\epsilon_\omega}{\epsilon_\omega}=2\vec{E}_\omega\cdot\nabla\log\left( n_\omega \right)
\end{equation*}
And, the right hand side becomes
\begin{equation*}
	\omega^2\mu_0\epsilon_\omega\vec{E}_\omega=\frac{\omega^2}{c^2}n_\omega^2\vec{E}_\omega
\end{equation*}
\begin{dfn}[Wavenumber]
	We define the \textit{vacuum wavenumber} $k_0$ as follows
	\begin{equation}
		k_0=\frac{\omega}{c}=\frac{2\pi}{\lambda}
		\label{eq:wavenumber.waves}
	\end{equation}
\end{dfn}
Reuniting both definitions and the simplification we then get, for the equation on $E$
\begin{equation*}
	\nabla^2\vec{E}_\omega+2\nabla\left( \vec{E}_\omega\cdot\nabla\log(n_\omega) \right)=k_0^2n_\omega^2\vec{E}_\omega
\end{equation*}
Now, in order to ease calculations in our range of frequencies (or wavelenghts, or wavenumbers also) we check if defined a characteristic length $l_n$ which indicates the spatial scale of variation of $n_\omega$ (remember that it depends on space position), we have that:
\begin{equation*}
	\begin{aligned}
		\nabla^2E_\omega&\propto\frac{E_\omega}{l_n\lambda}\frac{\Delta n_\omega}{n_\omega}\propto k_0^2n_\omega^2E_\omega\\
		\norm{\nabla\nabla\cdot\vec{E}_\omega}&\propto\frac{E_\omega}{l_n^2}\frac{\Delta n_\omega}{n_\omega}
	\end{aligned}
\end{equation*}
And since in optical ranges of light $l_n>>\lambda$ and $\Delta n_\omega<<n_\omega$ we can discard immediately the divergence term, and get two symmetric wave equations for the wave in a generic dielectric (nonmagnetic or transparent) medium
\begin{equation}
	\left\{ \begin{aligned}
			\nabla^2\vec{E}_\omega&= k_0^2n_\omega^2\vec{E}_\omega\\
			\nabla^2\vec{H}_\omega&= k_0^2n_\omega^2\vec{H}_\omega
	\end{aligned}\right.
	\label{eq:helmholtz.waves}
\end{equation}
These equations are known as \textit{Helmholtz equations} for the single chromatic part of the $E, H$ fields. Note that these equations are exactly the equations solved by a single Fourier component of the transformed wave equation ($n$ appears since we are in some media and $\epsilon_r\ne0$).\\
Note that via Fourier transforms it's possible to go back to the already known wave equation, where the speed of propagation is not $c$ but it's $c/n_\omega=u$. It's then also obvious that in vacuum $n_\omega=1$, which is also clear from the definition of the refraction index.\\
%%TODO waves appendix, phase-group velocity
\section{Vectorial Behavior of Electromagnetic Waves}
The general solution to the wave equation \eqref{eq:waveeq.waves} can be written both as a real function or a complex exponential. The latter one, although non ``real'', eases a lot calculations and therefore will be the favored approach. Using all previous definitions the general result is
\begin{equation}
	\begin{aligned}
		\vec{E}&= \vec{E}_0e^{i\vec{k}\cdot\vec{r}-i\omega t}\\
		\vec{H}&= \vec{H}_0e^{i\vec{k}\cdot\vec{r}-i\omega t}
	\end{aligned}
	\label{eq:wavesolution.waves}
\end{equation}
Evaluating the curl, the divergence and the time derivative for these solutions it's possible to write the following operator equation
\begin{equation}
	\begin{aligned}
		\hat{\del}_t&\to-i\omega\\
		\hat{\nabla}&\to i\vec{k}
	\end{aligned}
	\label{eq:operatorrel.waves}
\end{equation}
Where $\vec{k}$ is known as the \textit{wavevector}, which is the vector with magnitude $\norm{\vec{k}}=nk_0$
And Maxwell's equations can be rewritten as
\begin{equation}
	\left\{ \begin{aligned}
			\vec{k}\cdot\vec{E}&= 0\\
			\vec{k}\cdot\vec{H}&= 0\\
			\vec{k}\times\vec{E}&= \omega\mu_0\vec{H}\\
			\vec{k}\times\vec{H}&= -\omega\epsilon\vec{E}\\
	\end{aligned}\right.
	\label{eq:maxwellktimes.waves}
\end{equation}
Therefore, $\vec{k},\vec{E},\vec{H}$ are three mutually orthogonal vectors. By definition, then, $\vec{k}$ must be oriented parallel to the direction of motion.\\
Also from the last three equations, taken the norm of the two and solved the equations for $E/H$ we have
\begin{equation}
	\frac{E}{H}=n\sqrt{\frac{\epsilon_0}{\mu_0}}=\frac{n}{Z_0}
	\label{eq:impedancefs.waves}
\end{equation}
With $Z_0^2=\mu_0/\epsilon_0$ being the \textit{free space impedance} which has value of $Z_0\approx377\Omega$.
Note also that by definition of the Poynting vector $\vec{S}$, we also have that $\vec{k}\parallel\vec{S}$, which implies that, if we define the irradiance as $I=\norm{\vec{S}}$, that:
\begin{equation}
	\vec{S}=I\frac{\vec{k}}{k}=I\hat{\vec{k}}
	\label{eq:irradiance.waves}
\end{equation}
Or, using what we found before
\begin{equation}
	I=\frac{n}{2Z_0}E_0^2
	\label{eq:irradiancevse.waves}
\end{equation}
For plane waves it's actually better if we take the time average of the fields using phasor notation (complex exponential notation) for the fields, we have
\begin{equation*}
	\expval{\vec{S}(t)}=\vec{S}=\real{\expval{\vec{E}_0e^{i\vec{k}\cdot\vec{r}-i\omega t}}}\times\real{\expval{\vec{H}_0e^{i\vec{k}\cdot\vec{r}-i\omega t}}}
\end{equation*}
Since $\real(z)=\frac{1}{2}(z+\cc{z})$ and the complex conjugate is distributive, the calculation boils down to simplifying the following expression
\begin{equation*}
	\frac{1}{4}\expval{\left( \vec{E}_0\times\vec{H}_0e^{2i\vec{k}\cdot\vec{r}-2i\omega t}+\cc{\vec{E}}_0\times\vec{H}_0=\vec{E}_0\times\cc{\vec{H}}_0+\cc{\vec{E}}_0\times\cc{\vec{H}}_0e^{-2i\vec{k}\cdot\vec{r}+2i\omega t}\right)}
\end{equation*}
Noting that the average value for the real part of the exponential is $0$, we have 
\begin{equation}
	\vec{S}=\frac{1}{2}\vec{E}_0\times\cc{\vec{H}}_0 
	\label{eq:averagepoynting.waves}
\end{equation}
Where we omitted both the real part operator and the time average.
\subsection{Polarization}
The vectorial nature of waves comes up in most part with the phenomenon of \textit{polarization}, which is simply the ``favored'' direction of oscillation of the wave. Waves can also be non-polarized, as is the case for natural light, when there is no well defined oscillation direction.\\
The simplest polarization state obtainable is \textit{linear polarization}. Setting $\vec{k}\parallel\hat{\vec{z}}$ we have $\vec{E},\vec{H}$ orthogonal and coplanar on the $xy$ plane.\\
Linear polarization is then achieved when $\vec{E}$ oscillates with a constant angle from the chosen x axis. This can be expressed mathematically as:
\begin{equation}
	\vec{E}=E_x\hat{\vec{x}}+E_y\hat{\vec{y}}
	\label{eq:linear.pol}
\end{equation}
Note how here, in general, $\vec{E}\in\R^2$.\\
The instrument used to generate linearly polarized light is the \textit{linear polarizer}. This object is built in a way such that it transmits light only in one orientation. The associated axis is known as the \textit{transmission axis}.\\
Chosen a 2D orthonormal reference system $\hat{\vec{t}},\hat{\vec{s}}$ in which the $t$ axis is parallel to the transmission axis, then, we must have
\begin{equation*}
	\begin{aligned}
		\vec{E}_{in}&= E_t\hat{\vec{t}}+E_s\hat{\vec{s}}\\
		\vec{E}_{out}&= E_t\hat{\vec{t}}
	\end{aligned}
\end{equation*}
Since $E_t=E_{in}\cos\theta$ then the irradiance of the outgoing field is
\begin{equation}
	I_{out}=I_{in}\cos^2\theta
	\label{eq:malus.pol}
\end{equation}
This behavior is known as \textit{Malus' law}.\\
In case that the incoming light isn't polarized and it can't be described with the previous decomposition, taken the time average, we get
\begin{equation*}
	I_{out}=\frac{1}{2}I_{in}
\end{equation*}
Due to the superposition principle, it's not hard to imagine a mixture of polarized and unpolarized light. The \textit{degree of polarization} $P$ of this light can be evaluated using Malus' law, and it will be equal to
\begin{equation}
	P=\frac{I_{max}-I_{min}}{I_{max}+I_{min}}
	\label{eq:degpol.pol}
\end{equation}
Or, also, as the fraction of polarized irradiance
\begin{equation}
	P=\frac{I_{pol}}{I_{pol}+I_{unp}}
	\label{eq:degpol2.pol}
\end{equation}
There is one more possible (general) state of polarization, in which the field is totally described as a complex vector. In this state the two components of the field are dephased by exactly $\phi=\pi/2$, adding the phase to the exponential, we get a new factor of $i$ on one of the two components.\\
The field can then be described by a complex vector in the following way
\begin{equation}
	\vec{E}=E_0\hat{\vec{x}}+iE_1\hat{\vec{y}}
	\label{eq:elliptical.pol}
\end{equation}
This configuration is known as \textit{elliptical polarization} or \textit{circular polarization} when $E_1=E_0$, i.e.
\begin{equation}
	\vec{E}=E_0(\hat{\vec{x}}+i\hat{\vec{y}})
	\label{eq:circular.pol}
\end{equation}
This special polarization state has two version, called \textit{right hand} and \textit{left hand} polarization, depending on whether the dephasing between the components is $+i$ or $-i$. Left hand elliptical (circular) polarization is defined by a positive phase difference of $i$.\\
The instrumentation used to produce elliptical or circular polarization is known as \textit{quarter wave plates}, optical devices which exhibit a special property known as \textit{birefringence}, i.e., they have two different refraction indexes, $n_f, n_s$ where the subscripts mean ``slow'' and ``fast'' because $n_f<n_s$. The objects are specially made in a way such that the indexes are disposed in two mutually orthogonal axes.\\
The quarter wave denomination comes from the criterion used to choose the thickness of the slabs. In general, it depends from the wavelength of the beam that gets polarized with the following formula
\begin{equation}
	d=\frac{\lambda_0}{4(n_s-n_f)}
	\label{eq:qwp.pol}
\end{equation}
Note that a quarter wave plate isn't enough to generate circularly polarized light. In order to make both components equal after the dephasing, it's  necessary to linearly polarize light at an angle of $\pi/4$, so that when it traverses the quarter wave plate it's perfectly diagonal between the axes.
\subsection{Jones Calculus}
Due to the vectorial nature of polarization it's not hard to imagine a new notation which uses the power of linear algebra.\\
A generic wave will be described as follows
\begin{equation}
	\vec{E}=\begin{pmatrix}
		E_{x}e^{i\phi_x}\\
		E_ye^{i\phi_y}
	\end{pmatrix}
	\label{eq:jones.pol}
\end{equation}
This vector is known as a \textit{Jones vector}.\\
Then, the two basic polarization states are, in general
\begin{equation}
	\vec{E}_{lin}=\begin{pmatrix}
		A\\B
	\end{pmatrix}=A\begin{pmatrix}
		1\\0
	\end{pmatrix}+B\begin{pmatrix}
		0\\1
	\end{pmatrix}
	\label{eq:horizontal.jpol}
\end{equation}
Linear, when $A, B\in\R$, decomposed as a sum of horizontally and vertically polarized waves.\\
\begin{equation}
	\vec{E}=\begin{pmatrix}
		A\\\pm iB
	\end{pmatrix}=A\begin{pmatrix}
		1\\0
	\end{pmatrix}\pm B\begin{pmatrix}
		0\\i
	\end{pmatrix}
	\label{eq:elliptical.jpol}
\end{equation}
Elliptical, with $A, B\in\Cf$ in general decomposed into a sum of dephased linearly polarized light. Circularly polarized light can be interpreted as a special case with $A=B$.
All these polarization states can be treated with usual vector operations, and with it, it's possible to determine the final polarization state of two superimposed waves.\\
The action of \textit{optically active objects} such as linear polarizers and waveplates, can then be described by multiples of rotation matrices, which act linearly on the polarization states. The general action of an object is then described by a $2\times2$ complex \textit{Jones matrices}.\\
Using composition it's also possible to determine the action of multiple objects on the polarization state.\\
Some common optical objects have the following matrix reprsentations (when these is more thae one written I'm writing different orientations of the fast/transmission axis [$0, \pi, \pi/4$])\\
Linear polarizer:
\begin{equation}
	\begin{pmatrix}
		1&0\\0&0
	\end{pmatrix}\quad\begin{pmatrix}
		0&0\\0&1
	\end{pmatrix}\quad\frac{1}{2}\begin{pmatrix}
		1&\pm1\\\pm1&1
	\end{pmatrix}
	\label{eq:linpol.jpol}
\end{equation}
Quarter wave plate:
\begin{equation}
	\begin{pmatrix}
		1&0\\0&-i
	\end{pmatrix}\quad\begin{pmatrix}
		1&0\\0&i
	\end{pmatrix}\quad\frac{1}{\sqrt{2}}\begin{pmatrix}
		1&\pm i\\\pm i&1
	\end{pmatrix}
	\label{eq:qwp.jpol}
\end{equation}
Half wave plate:
\begin{equation}
	\begin{pmatrix}
		1&0\\0&-1
	\end{pmatrix}
	\label{eq:hwp.jpol}
\end{equation}
Phase retarder:
\begin{equation}
	\begin{pmatrix}
		e^{i\phi_x}&0\\0&e^{i\phi_y}
	\end{pmatrix}
	\label{eq:pr.jpol}
\end{equation}
Circular polarizer (quarter wave + diagonal polarizer):
\begin{equation}
	\frac{1}{2}\begin{pmatrix}
		1&\pm i\\\mp i
	\end{pmatrix}
	\label{eq:qwp+lp.jpol}
\end{equation}
Another thing we can borrow from algebra and use it with Jones calculus is orthogonality and eigenstates. Two polarization states are said to be \textit{orthogonal} if
\begin{equation}
	\vec{E}_1\cdot\vec{E}_2=\begin{pmatrix}
		\cc{A}&\cc{B}
	\end{pmatrix}\begin{pmatrix}
		C\\D
	\end{pmatrix}=\cc{A}C+\cc{B}D=0
	\label{eq:orth.jpol}
\end{equation}
A \textit{polarization eigenstate} instead is the eigenvector of a Jones matrix, i.e. the only thing that can change when light with this kind of polarization passes through the object is its phase and/or its amplitude.\\
Note how, since Jones vectors require \textit{purely} polarized states, we cannot define nonpolarized light.
\section{Boundary Conditions for Electromagnetic Waves}
\subsection{Snell's Law}
Consider a plane boundary separating two different optical media, with refraction indexes $n_1, n_2$. It's empirically proven from Huygens that the wave will be both transmitted and reflected at the boundary.\\
These three waves will have the following exponential dependence
\begin{equation*}
	\begin{aligned}
		e^{i\left( \vec{k}\cdot\vec{r}-\omega t \right)}\\
		e^{i\left( \vec{k}_R\cdot\vec{r}-\omega t \right)}\\
		e^{i\left( \vec{k}_T\cdot\vec{r}-\omega t \right)}
	\end{aligned}
\end{equation*}
Where $\vec{k}_R, \vec{k}_T$ are respectively the wavevectors for the reflected and transmitted wave.\\
Said, without loss of generality, $t=0$ at the boundary, due to the continuity of the field we must have
\begin{equation*}
	e^{i\vec{k}\cdot\vec{r}}=e^{i\vec{k}_R\cdot\vec{r}}=e^{i\vec{k}_T\cdot\vec{r}}
\end{equation*}
Writing in terms of $k_0$ which is the same, we have
\begin{equation*}
	\begin{aligned}
		\vec{k}&= n_1\vec{k}_0\\
		\vec{k}_R&= n_1\vec{k}_0\\
		\vec{k}_T&= n_2\vec{k}_0
	\end{aligned}
\end{equation*}
Said $\theta$ the incidence angle, $\theta_R$ the reflection angle and $\varphi$ the transmission angle, writing explicitly the norm of the scalar product, we get what's commonly known as \textit{Snell's law}
\begin{equation}
	\begin{aligned}
		\sin\theta_R&= \sin\theta\\
		n_1\sin\theta&= n_2\sin\varphi
	\end{aligned}
	\label{eq:snell.ref}
\end{equation}
The first one indicates that $\theta=\theta_R$, while the second can be rewritten as
\begin{equation}
	\sin\theta=n\sin\varphi
	\label{eq:snell2.ref}
\end{equation}
Where $n=n_2/n_1=\sin\theta/\sin\varphi$ is the \textit{relative refraction index} of the medium.
\subsection{Fermat's Principle}
All of this can be mathematically explained using \textit{Fermat's principle}.\\
Taken two points $A, B$, Fermat's principle states that light will travel in the path for which the traveling time will be minimized. Said $n\equiv n\left( \vec{r}(t) \right)$ we define the following functional
\begin{equation}
	t\left[ \vec{r} \right]=\int_{t_A}^{t_B}\frac{n\left( \vec{r}(t) \right)}{c}\dd^{}{t}
	\label{eq:time.fermat}
\end{equation}
Where we used $\dd t=u\dd s$.\\
We also define the \textit{optical path} as
\begin{equation}
	l_{AB}=\int_{A}^{B}n(s)\dd^{}{s}
	\label{eq:optpath.ref}
\end{equation}
Suppose now that $A, B$ are in two different media with $n_A, n_B$ as refraction indexes. Putting ourselves in the coordinate system of the incidence point, with the $y$ axis parallel to the boundary, and with $A, B$ distant respectively $d_1, d_2$ from the origin, we have that the total optical path is
\begin{equation*}
	l=d_1+d_2=\sqrt{a^2+x^2}+\sqrt{b^2+(d-x)^2}
\end{equation*}
Where $a, b$ are the $y$ distances of the two points. Dividing by $n/c$ we have
\begin{equation*}
	t(x)=\frac{n_A}{c}\sqrt{a^2+x^2}+\frac{n_B}{c}\sqrt{b^2+(d-x)^2}
\end{equation*}
Applying the fundamental principle of the calculus of variations, we take the derivative and search for the extremal
\begin{equation*}
	\pdv{t}{x}=\frac{n_Ax}{c\sqrt{a^2+x^2}}-\frac{n_B(d-x)}{c\sqrt{b^2+(d-x)^2}}=\frac{n_Ax\sqrt{b^2+(d-x)^2}-n_B(d-x)\sqrt{a^2-x^2}}{c\sqrt{a^2+x^2}\sqrt{b^2+(d-x)^2}}=0
\end{equation*}
Since the denominator is always not zero, everything boils down to
\begin{equation*}
	n_A^2x^2\left[ b^2+(d-x)^2 \right]=n_B^2(a^2+x^2)(d-x^2)
\end{equation*}
Now, taken the same coordinate system as the previous section, we write
\begin{equation*}
	\begin{aligned}
		x&= d_1\sin\theta\\
		b&= d_2\cos\varphi\\
		d-x&= d_2\sin\varphi\\
		a^2+x^2&= d_1^2
	\end{aligned}
\end{equation*}
Then, by substitution we get Snell's law for transmission
\begin{equation*}
	n_A^2d_1^2\sin^2\theta\left[ d_2^2\cos^2\varphi+d_2^2\sin^2\varphi \right]=n_Bd_1^2d_2^2\sin^2\varphi\implies n_A\sin\theta=n_B\sin\varphi
\end{equation*}
Putting $B$ in the same region as $A$ (so $n_B=n_A=n$, $\varphi\to\theta_R$) we have the reflection law
\begin{equation}
	d_1^2d_2^2\sin^2\theta=d_1^2d_2^2\sin^2\theta_R\implies\sin\theta=\sin\theta_R
	\label{eq:snellfermat-rf.ref}
\end{equation}
%%TODO TiKz graphs
\subsection{Fresnel Equations}
For now we only determined part of the behavior of the waves, since we are still missing what happens to the amplitudes.\\
Starting from equation \eqref{eq:maxwellktimes.waves} we rewrite the equations as
\begin{equation}
	\begin{aligned}
		\vec{E}&= -\frac{1}{\epsilon\omega}\vec{k}\times\vec{H}\\
		\vec{H}&= \frac{1}{\mu\omega}\vec{k}\times\vec{E}
	\end{aligned}
	\label{eq:maxwellktimes.ref}
\end{equation}
Now, the behavior at the boundary is described exactly from the boundary conditions (or jump conditions) of Maxwell's equations, therefore the polarization of the fields becomes important in the determination of the behavior! We will firstly consider cases where the $\vec{E}$ field is either parallel (p or $\pi$ polarization, from German Parallel) or transverse (s or $\sigma$ polarization, from German Senkrecht) to the \textit{incidence plane}, i.e. the plane where all three waves lay.\\
Fresnel's idea was to find the ratio between the incoming amplitude and the reflected or transmitted wave. These ratios are known as \textit{Fresnel coefficients}, and are strongly dependent on wave polarization. They are indicated as $r, t$\\
Consider firstly s polarization. The continuity relations are
\begin{equation}
	\begin{aligned}
		\vec{E}\cdot\hat{\vec{t}}+\vec{E}_R\cdot\hat{\vec{t}}&= \vec{E}_T\cdot\hat{\vec{t}}\\
		\vec{H}\cdot\hat{\vec{t}}-\vec{H}_R\cdot\hat{\vec{t}}&= \vec{H}_T\cdot\hat{\vec{t}}
	\end{aligned}
	\label{eq:spol-cont.ref}
\end{equation}
Calculating the dot products we have for $\vec{H}$
\begin{equation*}
	\begin{aligned}
		\vec{H}\cdot\hat{\vec{t}}&= H\cos\theta\\
		\vec{H}_R\cdot\hat{\vec{t}}&= -H_R\cos\theta\\
		\vec{H}_T\cdot\hat{\vec{t}}&= H_T\cos\varphi
	\end{aligned}
\end{equation*}
Therefore, using \eqref{eq:maxwellktimes.ref} we get the following system of equations
\begin{equation}
	\left\{ \begin{aligned}
		E&+E_R= E_T\\
		kE&\cos\theta-kE\cos\theta= k_TE_T\cos\varphi
	\end{aligned}\right.
	\label{eq:s-system.ref}
\end{equation}
Where $k=n_1k_0$ and $k_T=n_2k_0$.\\
Dividing by $k_0$ then we get
\begin{equation*}
	\left\{\begin{aligned}
		E&+E_R= E_T\\
		n_1(E&-E_R)\cos\theta= n_2E_T\cos\varphi
	\end{aligned}\right.
\end{equation*}
Substituting the first equation into the second and dividing by $E$ we have
\begin{equation*}
	\eval{\frac{E_R}{E}}_s=r_s=\frac{n_1\cos\theta-n_2\cos\varphi}{n_2\cos\varphi+n_1\cos\theta}
\end{equation*}
Using $n=n_2/n_1$ we have the first coefficient, $r_s$
\begin{equation}
	r_s=\frac{\cos\theta-n\cos\varphi}{\cos\theta+n\cos\varphi}
	\label{eq:r_s1.ref}
\end{equation}
We can also write
\begin{equation*}
	E_R=E_T-E
\end{equation*}
Therefore
\begin{equation*}
	n_1(2E-E_T)\cos\theta=n_2E_T\cos\varphi
\end{equation*}
Rearranging and dividing by $E$
\begin{equation*}
	\eval{\frac{E_T}{E}}_s=t_s=\frac{2n_1\cos\theta}{n_1\cos\theta+n_2\cos\varphi}
\end{equation*}
Or
\begin{equation}
	t_s=\frac{2\cos\theta}{\cos\theta+n\cos\varphi}
	\label{eq:t_s1.ref}
\end{equation}
Now, we switch to the orthogonal polarization state, $p$ polarization. Here, we have the same conditions for $\vec{H}$ as we had for $\vec{E}$ before and vice-versa, yielding
\begin{equation*}
	\left\{ \begin{aligned}
		H&-H_R= H_T\\
		E&\cos\theta+E_r\cos\theta=E_t\cos\varphi
	\end{aligned}\right.
\end{equation*}
Which becomes, using $H=kE$
\begin{equation*}
	\left\{ \begin{aligned}
		k&E-kE_R=k_TE_T\\
		E&\cos\theta+E_R\cos\theta=E_T\cos\varphi
	\end{aligned}\right.
\end{equation*}
Writing again $k=nk_0$ and dividing by $k_0$ we can write either
\begin{equation*}
	\begin{aligned}
		E_T&= \frac{n_1}{n_2}(E-E_R)\\
		E_R&= E-\frac{n_2}{n_1}E_T
	\end{aligned}
\end{equation*}
Inserting the first of the two into the system we get, after dividing by $E$
\begin{equation*}
	\eval{\frac{E_R}{E}}_p=r_p=\frac{\cos\theta-\frac{n_1}{n_2}\cos\varphi}{-\frac{n_1}{n_2}\cos\varphi-\cos\theta}
\end{equation*}
Rearranging and inserting the relative refraction index
\begin{equation}
	r_p=\frac{\cos\varphi-n\cos\theta}{\cos\varphi+n\cos\theta}
	\label{eq:r_p1.ref}
\end{equation}
Using the second instead we have
\begin{equation*}
	2E\cos\theta=E_T\left( \cos\varphi+\frac{n_2}{n_1}\cos\theta \right)
\end{equation*}
Which, after rearrangement, gives
\begin{equation}
	t_p=\frac{2\cos\theta}{\cos\varphi+n\cos\theta}
	\label{eq:t_p1.ref}
\end{equation}
Therefore, reuniting the results obtained from both polarizations we have
\begin{equation}
	\begin{aligned}
		r_s&= \frac{\cos\theta-n\cos\varphi}{\cos\theta+n\cos\varphi}\\
		t_s&= \frac{2\cos\theta}{\cos\theta+n\cos\varphi}\\
		r_p&= \frac{\cos\varphi-n\cos\theta}{\cos\varphi+n\cos\theta}\\
		t_p&= \frac{2\cos\theta}{\cos\varphi+n\cos\theta}
	\end{aligned}
	\label{eq:rtsp.ref}
\end{equation}
Using Snell's law we can eliminate also the relative refraction index using $n=\sin\theta\csc\varphi$, giving
\begin{equation}
	\begin{aligned}
		r_s&= \frac{\cos\theta-\sin\theta\cos\varphi\csc\varphi}{\cos\theta+\sin\theta\cos\varphi\csc\varphi}=\frac{\cos\theta\sin\varphi-\sin\theta\cos\varphi}{\cos\theta\sin\varphi+\sin\theta\cos\varphi}\\
		t_s&= \frac{2\cos\theta}{\cos\theta+\sin\theta\cos\varphi\csc\varphi}=\frac{2\cos\theta\sin\varphi}{\cos\theta\sin\varphi+\sin\theta\cos\varphi}\\
		r_p&= \frac{\cos\varphi-\sin\theta\cos\theta\csc\varphi}{\cos\varphi+\sin\theta\cos\varphi\csc\varphi}=\frac{\cos\varphi\sin\varphi-\sin\theta\cos\theta}{\cos\varphi\sin\varphi+\sin\theta\cos\theta}\\
		t_p&= \frac{2\cos\theta}{\cos\varphi+\cos\theta\sin\theta\csc\varphi}=\frac{2\cos\theta\sin\varphi}{\cos\varphi\sin\varphi+\sin\theta\cos\theta}
	\end{aligned}
	\label{eq:fresnelpre.ref}
\end{equation}
Using the following trigonometric identities we can simplify things even more
\begin{equation*}
	\begin{aligned}
		\sin\theta\cos\phi-\cos\theta\sin\varphi&= \sin(\theta-\varphi)\\
		\sin\theta\cos\theta-\cos\varphi\sin\varphi&= \sin(\theta-\varphi)\cos(\theta+\varphi)\\
		\cos\varphi\sin\varphi+\sin\theta\cos\theta&= \sin(\theta+\varphi)\cos(\theta-\varphi)
	\end{aligned}
\end{equation*}
And in the end obtain what are known as \textit{Fresnel equations} for reflection and refraction of electromagnetic waves
\begin{equation}
	\begin{aligned}
		r_s&= -\frac{\sin(\theta-\varphi)}{\sin(\theta+\varphi)}\\
		t_s&= \frac{2\cos\theta\sin\varphi}{\sin(\theta+\varphi)}\\
		r_p&= -\frac{\tan(\theta-\varphi)}{\tan(\theta+\varphi)}\\
		t_p&= \frac{2\cos\theta\sin\varphi}{\sin(\theta+\varphi)\cos(\theta-\varphi)}
	\end{aligned}
	\label{eq:fresnel.ref}
\end{equation}
\subsubsection{Fresnel Equations for Irradiance and General Polarization}
From equation \eqref{eq:irradiancevse.waves} we can define the \textit{luminous power of a beam} as 
\begin{equation}
	W=SI=\frac{n_iS}{2Z_0}E^2
	\label{eq:lumpower.ref}
\end{equation}
Where $S$ is the surface of the cross-section of the beam.\\
It's not hard to then generalize this concept to reflected and refracted beams. Inserting $n_1, n_2$ in the previous formula, where both indexes are defined exactly as before we get
\begin{equation*}
	\begin{aligned}
		W&= \frac{n_1S}{2Z_0}E^2\\
		W_R&= \frac{n_1S_R}{2Z_0}E_R^2\\
		W_T&= \frac{n_2S_T}{2Z_0}E_T^2
	\end{aligned}
\end{equation*}
With $S_R, S_T$ being the cross-sections of the respective beams.\\
We define the \textit{reflectance} $R$ and the \textit{transmittance} $T$ as the ratio of incoming vs reflected/transmitted power
\begin{equation}
	\begin{aligned}
		R&= \frac{W_R}{W}=\frac{n_1S_R}{2Z_0}\frac{2Z_0}{n_1S}r^2=r^2\\
		T&= \frac{W_T}{W}=\frac{n_2S\cos\varphi}{2Z_0}\frac{2Z_0}{n_1S\cos\theta}t^2=\frac{n\cos\varphi}{\cos\theta}t^2\\
	\end{aligned}
	\label{eq:RT.ref}
\end{equation}
The polarization here can be either $p$ or $s$. In general tho, light can be also be polarized in some random direction which can be described by a mix of $p$ and $s$ polarizations.\\
In the case of general polarization, we have
\begin{equation*}
	\begin{aligned}
		\vec{E}&= E_s\hat{\vec{s}}+E_p\hat{\vec{p}}\\
		\vec{E}_R&= r_sE_s\hat{\vec{s}}+r_pE_p\hat{\vec{p}}\\
		\vec{E}_T&= t_sE_s\hat{\vec{s}}+t_pE_p\hat{\vec{p}}\\
	\end{aligned}
\end{equation*}
Squaring and multiplying by $n_{i}/Z_{0}$ we get both $I_R$ and $I_T$
\begin{equation*}
	\begin{aligned}
		I_{R}&= \frac{n_1S_R}{Z_0}\left( r_s^2I_s+r_p^2I_p \right)\\
		I_T&= \frac{n_2S_T}{Z_0}\left( t_s^2I_s+t_p^2I_p \right)
	\end{aligned}
\end{equation*}
Dividing by $I_0$ we have then
\begin{equation}
	\begin{aligned}
		R&= \frac{I_R}{I_0}=r_s^2\frac{I_R}{I_0}+r_p^2\frac{I_T}{T_0}=R_s\frac{I_s}{I_0}+R_p\frac{I_p}{I_0}\\
		T&= \frac{n\cos\varphi}{\cos\theta}\left( t_s^2\frac{I_s}{I_0}+t_p^2\frac{I_p}{I_0} \right)=T_s\frac{I_s}{I_0}+T_p\frac{I_p}{I_0}
	\end{aligned}
	\label{eq:RTgenpol.ref}
\end{equation}
\section{Special Angles}
Taken the equations \eqref{eq:fresnel.ref} using simple mathematical analysis it's clear that there are some special angles for which there is some special behavior. These angles are known in literature as
\begin{itemize}
\item Brewster angle
\item Near grazing incidence angle
\item Normal incidence angle
\end{itemize}
\subsection{Brewster Angle}
The first one is the so called \textit{Brewster angle}. Taken Fresnel's equations for the reflection coefficients
\begin{equation*}
	\begin{aligned}
		r_s&= -\frac{\sin(\theta-\varphi)}{\sin(\theta+\varphi)}\\
		r_p&= -\frac{\tan(\theta-\varphi)}{\tan(\theta+\varphi)}
	\end{aligned}
\end{equation*}
It's clear that $r_s$ can never be $0$ for $\theta\in\left[ 0, \pi/2 \right]$, which is not the case for $r_p$. The angle, $\theta_B$, for which $r_p(\theta_B)=0$ is Brewster's angle.\\
At this incidence angle, all light reflected is s-polarized. From the tangent formula we have
\begin{equation*}
	r_p(\theta_B)=0\implies\varphi=\frac{\pi}{2}-\theta_B
\end{equation*}
From Snell's law we have that
\begin{equation*}
	\sin\left(  \theta_B\right)=n\sin\left( \frac{\pi}{2}-\theta_B \right)=n\cos\left( \theta_B \right)
\end{equation*}
Therefore
\begin{equation*}
	n=\frac{\sin\theta_B}{\cos\theta_B}
\end{equation*}
Which gives
\begin{equation}
	\theta_B=\arctan(n)
	\label{eq:brewster.ref}
\end{equation}
From the definition of relative index of refraction we can also say that
\begin{equation}
	\theta_B=\begin{dcases}
		>\frac{\pi}{4} & n_1<n_2\\
		\frac{\pi}{4} & n_1=n_2\\
		<\frac{\pi}{4} & n_1>n_2
	\end{dcases}
	\label{eq:brewster-anal.ref}
\end{equation}
\subsection{Normal Incidence and Near Grazing Incidence}
Another two special angles are at the limits of the interval, at $\theta=0$ (normal incidence) and $\theta=\pi/2$ (grazing incidence).\\
At $\theta=0$ we have
\begin{equation*}
	\sin\varphi=0
\end{equation*}
I.e.
\begin{equation}
	\left\{ \begin{aligned}
			r_s&= \frac{1-n}{1+n}\\
			t_s&= \frac{2}{1+n}\\
			r_p&= \frac{n-n^2}{n+n^2}=r_s\\
			t_p&= \frac{2}{1+n}=t_s
	\end{aligned}\right.
	\label{eq:normalinc.ref}
\end{equation}
At normal incidence then, the polarization of the wave is irrelevant, and the transmitted/reflected waves' amplitude will depend only on the properties of the material.\\
At $\theta=\pi/2$ instead we get
\begin{equation*}
	\sin\varphi=\frac{1}{n}\implies\cos\varphi=\frac{1}{n}\sqrt{n^2-1}
\end{equation*}
Which, in terms of Fresnel coefficients
\begin{equation}
	\left\{ \begin{aligned}
			r_s&= -\frac{\sqrt{n^2-1}}{\sqrt{n^2-1}}=-1\\
			r_p&= 1\\
			t_s&= t_p=0
	\end{aligned}\right.
	\label{eq:grazinginc.ref}
\end{equation}
I.e. the wave is only reflected, and the difference between the two polarization states is only a phase shift of $\pi$.
\section{Total Internal Reflection}
For each angle of incidence between $0$ and $\pi/2$ it's possible to distinguish two kinds of reflection
\begin{itemize}
\item External reflection, when $n>1$
\item Internal reflection, when $n<1$
\end{itemize}
This distinction is clearer if we rewrite $\cos\varphi$ in terms of $\sin\theta$, as follows from Snell's law
\begin{equation*}
	\cos\varphi=\frac{1}{n}\sqrt{n^2-\sin^2\theta}
\end{equation*}
It's then clear that in general, $\cos\varphi\in\Cf$, i.e. there exists an angle $\theta_c$ for which, when $\theta>\theta_c$ the cosine is complex. This angle is known as the \textit{critical angle}, defined by
\begin{equation}
	\sin\theta_c=n\implies\theta_c=\arcsin(n)
	\label{eq:critang.tir}
\end{equation}
In the regime of $\theta\ge\theta_c$, all Fresnel coefficients are complex and, particularly, it can be proven that 
\begin{equation}
	\begin{aligned}
		r_s\cc{r_s}&=r_p\cc{r_p}=1\\
		t_s&= t_p=0
	\end{aligned}
	\label{eq:rt.tir}
\end{equation}
This gives the name to the regime that we're studying, \textit{total internal reflection}, or TIR as we'll call it. The nonzero Fresnel coefficients are then $r_s, r_p$, which can be written explicitly complex using $\sqrt{n^2-\sin^2\theta}=i\sqrt{\sin^2\theta-n^2}$
\begin{equation}
	\begin{aligned}
		r_s&= \frac{\cos\theta-i\sqrt{\sin^2\theta-n^2}}{\cos\theta+i\sqrt{\sin^2\theta-n^2}}\\
		r_p&= \frac{-n^2\cos\theta+i\sqrt{\sin^2\theta-n^2}}{n^2\cos\theta+i\sqrt{\sin^2\theta-n^2}}
	\end{aligned}
	\label{eq:rsrp.tir}
\end{equation}
\subsection{Fiber Optics}
The main technological usage of TIR are fiber optics. These cables are built similarly to coaxial cables, where the cable (with refraction index $n_1$) is covered by a coating (with refraction index $n_2$) with materials which give $n=n_1/n_2<1$. In order to be in TIR regime, the beam must be incident at a particular angle, such that $\theta>\theta_c$. For purely technical reasons this angle is known as the \textit{acceptance angle} $\alpha$.\\
Define an angle related to this $\alpha$ as:
\begin{equation*}
	\frac{\pi}{2}-\alpha'=\theta_c
\end{equation*}
From the definition of $\theta_c$ we have then
\begin{equation*}
	\cos\alpha'=n
\end{equation*}
And therefore, also
\begin{equation*}
	\sin\alpha'=\frac{1}{n_1}\sqrt{n_1^2-n_2^2}
\end{equation*}
We then define $\alpha$ as follows
\begin{equation}
	\sin\alpha=n_1\sin\alpha'=\sqrt{n_1^2-n_2^2}
	\label{eq:accangsnell.tir}
\end{equation}
Which implies
\begin{equation}
	\alpha=\arcsin\left( \sqrt{n_1^2-n_2^2} \right)
	\label{eq:accang.tir}
\end{equation}
\subsubsection{Evanescent Waves}
Consider now the field inside a fiber optic cable (in TIR regime in general). The field inside the cable is the field transmitted from the first reflection, and is
\begin{equation*}
	\vec{E}_T(\vec{r}, t)=\vec{E}_Te^{i\vec{k}_T\cdot\vec{r}-i\omega t}
\end{equation*}
But, we have that 
\begin{equation*}
	\vec{k}_T\cdot\vec{r}=k_Tx\sin\varphi+k_Ty\cos\varphi
\end{equation*}
But, from Snell's law, and the fundamental equation of trigonometry, that
\begin{equation*}
	\cos\varphi=\frac{1}{n}\sqrt{n^2-\sin^2\theta}=\frac{i}{n}\sqrt{\sin^2\theta-n^2}
\end{equation*}
Where we considered that we are in TIR, i.e. $\theta>\theta_C$ and $\sin^2\theta>n^2$
Therefore, said
\begin{equation*}
	\begin{aligned}
		a&= \frac{k_T}{n}\sqrt{\sin^2\theta-n^2}\\
		k_x&= \frac{k_T\sin\theta}{n}
	\end{aligned}
\end{equation*}
Which, if inserted into the field equation, give
\begin{equation}
	\vec{E}_T(x, y, t)=\vec{E}_Te^{-a\abs{y}}e^{ik_xx-i\omega t}
	\label{eq:evanescentwave.tir}
\end{equation}
Measuring the field along the $y$ axis, there's a part of the wave which decays exponentially, known as the \textit{evanescent wave}. Note that the evanescent wave decays really rapidly, in fact, for visible light, $a\propto10^6\ \mathrm{m^{-1}}$. It's clear that this wave will be really faint even at really close distances, and it's measurable only by really sensible detectors.
\subsection{Phase Shift in TIR}
One consequence of TIR is that, even if the amplitude of the wave isn't changed after each reflection ($\abs{r}=1$), the complex nature of the Fresnel coefficients adds in a phase on the wave.\\
From basic complex analysis, since both $r_s, r_p\in\Cf$, we can write both the coefficients as a constant ($\abs{r}$) times a complex exponential, which will have the added phase as its argument. Therefore, in general
\begin{equation*}
	\begin{aligned}
		r_s&= e^{-i\delta_s}=\frac{ae^{-i\alpha}}{ae^{i\alpha}}\\
		r_p&= -e^{-i\delta_p}=-\frac{be^{-i\beta}}{be^{i\beta}}
	\end{aligned}
\end{equation*}
Using the following fact
\begin{equation*}
	\tan(\theta)=\frac{\imaginary\left\{re^{-i\theta}\right\}}{\real\left\{re^{-i\theta}\right\}}
\end{equation*}
We can write, using equations \eqref{eq:rsrp.tir}, and noting that $\delta_s=2\alpha$, $\delta_p=2\beta$ that
\begin{equation*}
	\begin{aligned}
		\tan(\alpha)&= \tan\left( \frac{\delta_s}{2} \right)=\frac{\sqrt{\sin^2\theta-n^2}}{\cos\theta}\\
		\tan(\beta)&= \tan\left( \frac{\delta_p}{2} \right)=\frac{\sqrt{\sin^2\theta-n^2}}{n^2\cos\theta}
	\end{aligned}
\end{equation*}
Which gives, as a relative phase difference $\Delta=\beta-\alpha$
\begin{equation}
	\tan\left( \frac{\delta_p-\delta_s}{2} \right)=\tan\left( \frac{\Delta}{2} \right)=\frac{\cos\theta\sqrt{\sin^2\theta-n^2}}{\sin^2\theta}
	\label{eq:tanphdiff.tir}
\end{equation}
Which gives
\begin{equation}
	\Delta=2\arctan\left( \frac{\cos\theta\sqrt{\sin^2\theta-n^2}}{\sin^2\theta} \right)
	\label{eq:phdiff.tir}
\end{equation}
\subsection{Fresnel's Rhomb}
The results obtained from the previous section show that it's possible to polarize light using TIR and the right incidence angle. One optical instrument that serves this purpose is the so called \textit{Fresnel rhomb}, a literal transparent rhomb that transforms linearly polarized light to circularly polarized light.\\
The rhomb has the two major sides inclined by 54 degrees (air-air). In this configuration, linearly polarized light at 45 degrees endures two total internal reflections and gets transmitted as circularly polarized light.\\
For each reflection, in this configuration, we get
\begin{equation*}
	\Delta=\frac{\pi}{4}
\end{equation*}
Summed up for both reflections, we get a total phase change between $s$ and $p$ polarized light of
\begin{equation*}
	\Delta_{tot}=\frac{\pi}{2}
\end{equation*}
Which is what defines circular polarization.
\section{Reflection and Transmission Matrices}
As we saw before, polarization states can be described using a comfortable polarization basis. In the case of reflection and refraction this basis is obviously given by the versors $\hat{\vec{s}}$ and $\hat{\vec{p}}$, parallel to the perpendicular (s) or the parallel (p) direction with respect to the incidence plane. This system is obviously orthogonal, and the basis vectors are clearly described as
\begin{equation}
	\hat{\vec{p}}=\begin{pmatrix}
		1\\0
	\end{pmatrix}\qquad\hat{\vec{s}}=\begin{pmatrix}
		0\\1
	\end{pmatrix}
	\label{eq:reflrefrbasis.rjon}
\end{equation}
A generally polarized wave therefore can be described as a linear composition of these two vectors, i.e.
\begin{equation*}
	\vec{E}=\begin{pmatrix}
		A\\B
	\end{pmatrix}=A\begin{pmatrix}
		1\\0
	\end{pmatrix}+B\begin{pmatrix}
		0\\1
	\end{pmatrix}=A\hat{\vec{p}}+B\hat{\vec{s}}
\end{equation*}
The reflection and the refraction of a beam, considered their linear behavior with respect to the generic wave, can then be described as a matrix. This matrix is 
\begin{equation}
	r^i_j=\begin{pmatrix}
		-r_p&0\\
		0&r_s
	\end{pmatrix}
	\label{eq:refmatrix.rjon}
\end{equation}
Analogously, the transmission matrix is
\begin{equation}
	t^i_j=\begin{pmatrix}
		t_p&0\\
		0&t_s
	\end{pmatrix}
	\label{eq:transmatrix.rjon}
\end{equation}
From these results it's possible to write the transmission and reflection matrices for special angles, especially for near grazing incidence and normal incidence.\\
\begin{itemize}
\item Normal incidence
	\begin{equation}
		r^i_j(0)=\frac{1-n}{1+n}\begin{pmatrix}
			-1&0\\
			0&1
		\end{pmatrix}
		\label{eq:rmatninc.rjon}
	\end{equation}
\item Near grazing incidence/grazing incidence
	\begin{equation}
		r^i_j\left( \frac{\pi}{2} \right)=\begin{pmatrix}
			-1&0\\
			0&1
		\end{pmatrix}
		\label{eq:rmatnginc.rjon}
	\end{equation}
\end{itemize}
For TIR the results are slightly different, due to the complex nature of $r$. As we wrote before, we have
\begin{equation*}
	\begin{aligned}
		r_s&= e^{-i\delta_s}\\
		r_p&= -e^{-i\delta_p}
	\end{aligned}
\end{equation*}
Therefore
\begin{equation}
	r^i_j=\begin{pmatrix}
		-e^{-i\delta_p}&0\\
		0&e^{-i\delta_s}
	\end{pmatrix}=e^{-i\delta_p}\begin{pmatrix}
		-1&0\\
		0&e^{i\Delta}
	\end{pmatrix}
	\label{eq:rmattir.rjon}
\end{equation}
With this definition, the dephasement ensued after TIR is really vivid.\\
Note that applying this matrix to a generally polarized wave $\vec{E}$ we have in general an elliptically polarized outgoing wave, as
\begin{equation}
	E_R^i=r^i_jE^j=e^{-i\delta_p}\begin{pmatrix}
		-1&0\\
		0&e^{i\Delta}
	\end{pmatrix}\begin{pmatrix}
		A\\B
	\end{pmatrix}=e^{-i\delta_p}\begin{pmatrix}
		-A\\Be^{i\Delta}
	\end{pmatrix}
	\label{eq:tireff.rjon}
\end{equation}
Note that there is a generic phase change outside the resulting wave (which doesn't affect the polarization state), while there's a dephasement on the second component, which depends directly on $\delta_p-\delta_s$, that factor, on the other hand, is the one that will change the polarization state into, generally, an elliptical state.\\
In the most general case, we can define the \textit{Fresnel-Jones matrices}, which are the most general expression of reflection-refraction problems of polarized waves
\begin{equation}
	\begin{aligned}
		r^i_j&= -\begin{pmatrix}
		\tan\left( \theta-\varphi \right)\cot\left( \theta+\varphi \right)&0\\
		0&\sin\left( \theta-\varphi \right)\csc\left( \theta+\varphi \right)
		\end{pmatrix}\\
		t^i_j&= \frac{2\cos\theta\sin\phi}{\sin\left( \theta+\varphi \right)}\begin{pmatrix}
		\sec\left( \theta-\varphi \right)&0\\
			0&1
		\end{pmatrix}
	\end{aligned}
	\label{eq:fresneljones.rjon}
\end{equation}
\section{Theory of Multilayer Films}
The laws of reflection and refraction can be used in multiple ways in order to create special optically active instruments, like antireflecting lenses for glasses, highly-reflecting lenses, heat-reflecting or heat-transmitting surfaces and lenses which reflect only one specific wavelength of light.\\
These peculiar instruments, which some of them are also really common (see antireflecting glasses or blue-light protection glasses) are made by superimposing various thin strata of material with different refraction indexes $n_i$.\\
\subsection{Transfer Matrix}
In order to study the physics behind, we'll start with only two layers, which separate an ``incoming'' zone with index $n_0$ from an ``outgoing'' zone with index $n_T$, with index $n_1$ in between.\\
In this case, we will have, after applying simple logic and the idea of reflection and transmission of light:
\begin{itemize}
\item An incoming wave, \textit{outside} of the film, where the reflection index is some value $n_0$, and the wave is described by $(\vec{k},\vec{E},\vec{H})$
\item A wave reflected from the first layer (it's still outside of the layer, hence the refraction index is $n_0$), described by $(\vec{k}_R,\vec{E}_R,\vec{H}_R)$
\item A wave transmitted from the first layer, here the refraction index is $n_1$, described by $(\vec{k}_1,\vec{E}_1,\vec{H}_1)$
\item A wave reflected from the second layer, (here the refraction index is \textit{still} $n_1$), described by $(\vec{k}_R',\vec{E}_R',\vec{H}_R')$
\item A wave transmitted from the second layer, finally outside the film, where the refraction index is $n_T$ and the wave will be $(\vec{k}_T,\vec{E}_T,\vec{H}_T)$
\end{itemize}
If we choose, for ease of calculation, the origin at the first layer, the equations for this layer will be similar to what we saw before for a single reflection and refraction. The same goes for the second layer, remembering tho that after having traveled a distance $l$ we will have $E'=Ee^{ikl}$.\\
Everything considered then we will have a system of four coupled equations in four unknowns, which we will separate into two coupled systems that represent the two different layers. We chose, for ease of calculation, to evaluate only normal reflection.
\begin{equation}
	\left\{ \begin{aligned}
		E+E_R&= E_1+E_R'\\
		n_0\left( E-E_R \right)&= n_1\left( E_1-E_R' \right)
	\end{aligned}\right.
	\qquad
	\left\{ \begin{aligned}
		E_1e^{ikl}+E_R'e^{-ikl}&= E_T\\
		n_1\left( E_1e^{ikl}-E_R'e^{-ikl} \right)&= n_TE_T
	\end{aligned}\right.
	\label{eq:freq.mlt}
\end{equation}
Where we used $H_i=(\mu\omega)^{-1}n_ik_0E_i$ on the second equation of both systems.
We begin by solving for the second layer. From the second equation we have
\begin{equation*}
	E_T=\frac{n_1}{n_T}\left( E_1e^{ikl}-E_R'e^{-ikl} \right)
\end{equation*}
Then, inserting it in the first equation
\begin{equation*}
	E_1e^{ikl}+E_R'e^{-ikl}=\frac{n_1}{n_T}\left( E_1e^{ikl}-E_R'e^{-ikl} \right)
\end{equation*}
Reuniting the terms with the same amplitude we get
\begin{equation*}
	\left( 1-\frac{n_1}{n_T} \right)E_1e^{ikl}=-\left( 1+\frac{n_1}{n_T} \right)E_R'e^{-ikl}
\end{equation*}
Or, developing the sum, multiplying by the inverse of the result on the left and on the right and dividing by $E_R'$, we have
\begin{equation*}
	\frac{E_1}{E_R'}=\frac{n_1+n_T}{n_1-n_T}e^{-2ikl}\qquad\frac{E_R'}{E_1}=\frac{n_1-n_T}{n_1+n_T}e^{2ikl}
\end{equation*}
Taken again the first equation of the second layer in \eqref{eq:freq.mlt} and dividing everything by $E_1$ and $E_R'$, we find ourselves a new solvable system
\begin{equation*}
	\left\{\begin{aligned}
		e^{ikl}+\frac{E_R'}{E_1}e^{-ikl}&= \frac{E_T}{E_1}\\
		\frac{E_1}{E_R'}e^{ikl}+e^{-ikl}&= \frac{E_T}{E_R'}
	\end{aligned}\right.
\end{equation*}
Inserting what we found before we have, for the first equation
\begin{equation*}
	e^{ikl}+\left( \frac{n_1-n_T}{n_1+n_T}e^{2ikl} \right)e^{-ikl}=\frac{E_T}{E_1}
\end{equation*}
Or, solving by regrouping the exponentials
\begin{equation*}
	\frac{E_T}{E_1}=\frac{2n_1}{n_1+n_T}e^{ikl}
\end{equation*}
Analogously for the second equation we get
\begin{equation*}
	\frac{E_T}{E_R'}=\frac{2n_1}{n_1-n_T}e^{-ikl}
\end{equation*}
Rewriting $E_1, E_R'$ in terms of $E_T$, the whole system \eqref{eq:freq.mlt} becomes
\begin{equation}
	\left\{ \begin{aligned}
		E+E_R&= E_1+E_R'\\
		n_0\left( E-E_R \right)&= n_1\left( E_1-E_R' \right)
	\end{aligned}\right.
	\qquad
	\left\{ \begin{aligned}
			E_R'&= \frac{n_1-n_T}{2n_1}E_Te^{ikl}\\
			E_1&= \frac{n_1+n_T}{2n_1}E_Te^{-ikl}
	\end{aligned}\right.
	\label{eq:almostsolved.mlt}
\end{equation}
Inserting the results of the second system into the first we get
\begin{equation*}
	\left\{ \begin{aligned}
			E+E_R&= \left( \frac{n_1-n_T}{2n_1}e^{-ikl}+\frac{n_1-n_T}{2n_1}e^{ikl} \right)E_T
			n_0\left( E+E_R \right)&= n_1\left( \frac{n_1-n_T}{2n_1}e^{-ikl}-\frac{n_1-n_T}{2n_1}e^{ikl} \right)E_T
	\end{aligned}\right.
\end{equation*}
Regrouping on the right with respect to the refraction indexes we get on the first equation
\begin{equation*}
	E+E_R=\frac{1}{2n_1}\left[ n_1\left( e^{-ikl}+e^{ikl} \right)+n_T\left( e^{-ikl}-e^{ikl} \right) \right]E_T
\end{equation*}
Using the usual identities for sines and cosines and bringing in the factor on the left we get
\begin{equation*}
	E+E_R=\left( \cos(kl)-i\frac{n_T}{n_1}\sin(kl) \right)E_T
\end{equation*}
And analogously, for the second equation
\begin{equation*}
	n_0\left( E-E_R \right)=\left( -in_1\sin(kl)+n_T\cos(kl) \right)E_T
\end{equation*}
Remembering the definition of $r$ and $t$, we can rewrite the system in terms of both Fresnel parameters dividing by $E$
\begin{equation}
	\left\{ \begin{aligned}
			1+r&= \left( \cos{kl}-i\frac{n_T}{n_1}\sin(kl) \right)t\\
			n_0\left( 1-r \right)&= \left( -in_1\sin(kl)+n_T\cos(kl) \right)t
	\end{aligned}\right.
	\label{eq:trsystem.mlt}
\end{equation}
This system can clearly be rewritten in matrix terms as follows
\begin{equation}
	\begin{pmatrix}
		1\\n_0
	\end{pmatrix}+\begin{pmatrix}
		1\\-n_0
	\end{pmatrix}r=\begin{pmatrix}
		\cos(kl)&-\frac{i}{n_1}\sin(kl)\\
		-in_1\sin(kl)&\cos(kl)
	\end{pmatrix}\begin{pmatrix}
		1\\n_T
	\end{pmatrix}t
	\label{eq:transfermatrix.mlt}
\end{equation}
Here, the left hand side represent the discontinuity equations for the first layer, while the right hand side represents the discontinuity equations on the second layer. The matrix, known as the \textit{transfer matrix}, ``transfers'' the equation from the first boundary to the second, where the discontinuity equations are applied.\\
Generalizing to multilayer films composed by $n$ layers, we can immediately find the transfer matrix of the whole system using simple matrix multiplication. Said $M^i_j$ the transfer matrix of this system, then we have, if the matrix of the $k-$th layer is $M^{i_k}_{j_k}$ that
\begin{equation}
	\prod_{k=1}^nM^{i_k}_{j_k}=M^i_j=\begin{pmatrix}
		A&B\\C&D
	\end{pmatrix}
	\label{eq:generalmultilayermatrix.mlt}
\end{equation}
Therefore, the general Fresnel equation becomes
\begin{equation}
	\begin{pmatrix}
		1\\n_0
	\end{pmatrix}+\begin{pmatrix}
		1\\-n_0
	\end{pmatrix}r=\begin{pmatrix}
		A&B\\C&D
	\end{pmatrix}\begin{pmatrix}
		1\\n_T
	\end{pmatrix}t
	\label{eq:generalfreq.mlt}
\end{equation}
This equation is readily solvable for both $r, t$. Rewriting everything as a system of two equations, we have
\begin{equation*}
	\left\{\begin{aligned}
		1+r&= \left( A+Bn_T \right)t\\
		n_0(1-r)&= \left( C+Dn_T \right)t
	\end{aligned}\right.
\end{equation*}
From the first equation we get $r(t)$, which inserted in the second equation gives
\begin{equation*}
	2n_0-n_0\left( A+n_TB \right)t=(C+n_T)t
\end{equation*}
Which solved gives
\begin{equation}
	t=\frac{2n_0}{n_0A+n_0n_TB+n_TD+C}
	\label{eq:tcoeff.mlt}
\end{equation}
Reinserting it into the first equation, we have also the result for $r$
\begin{equation}
	r=\frac{n_0A+n_0n_TB-n_TD-C}{n_0A+n_0n_TB+n_TD+C}
	\label{eq:rcoeff.mlt}
\end{equation}
If the elements of the transmission matrix are known, then it's possible to find the reflectance and transmittance of the complete multilayer by remembering that $R=\norm{r}^2$, $T=\norm{t}^2$
\subsection{Antireflecting Films}
One of the applications of multilayer theory we indicated before are \textit{antireflecting films}, which are the reason that we can build and use antireflecting lenses in cameras and glasses, and for the watch enthusiasts, also have antireflecting sapphire crystals.\\
Considering this real-world usage, we will suppose that the antireflecting film is placed over a glass (or sapphire) surface with refraction index $n_T$, and on the other side the light is immersed in air, with refraction index $n_0=1$, while the layer of antireflecting material has refraction index $n_1$.\\
The transfer matrix of the system is
\begin{equation*}
	M^i_j=\begin{pmatrix}
		A&B\\C&D
	\end{pmatrix}=\begin{pmatrix}
		\cos(kl)&-\frac{i}{n_1}\sin(kl)\\
		-in_1\sin(kl)&\cos(kl)
	\end{pmatrix}
\end{equation*}
The equation for the reflection coefficient is as before \eqref{eq:rcoeff.mlt}, which, after substituting the matrix elements and regrouping the common factor is
\begin{equation*}
	r=\frac{(1-n_T)\cos(kl)-i\left( \frac{n_T}{n_1}-n_1 \right)\sin(kl)}{(1+n_T)\cos(kl)-i\left( \frac{n_T}{n_1}+n_1 \right)\sin(kl)}
\end{equation*}
Multiplying and dividing both denominator and numerator we get the much simpler result
\begin{equation}
	r=\frac{n_1(1-n_T)\cos(kl)-i(n_T-n_1^2)\sin(kl)}{n_1(1+n_T)\cos(kl)-i(n_T+n_1^2)\sin(kl)}
	\label{eq:rcoeff.arc}
\end{equation}
Now, here the reflectance is not necessarily $0$, but we can manipulate the parameters of the layer in order to get it to become null for the desired frequency.\\
The easiest to mechanically manipulate is the thickness $l$ of the layer. In fact, if we take $l=\lambda/4$ we have
\begin{equation}
	kl=\frac{k\lambda}{4}=\frac{2\pi\lambda}{4\lambda}=\frac{\pi}{2}
	\label{eq:whylambdafourths.arc}
\end{equation}
Inserting this awesome result we get for $r$ and $R$
\begin{equation}
	r=\frac{n_T-n_1^2}{n_T+n_1^2}, \qquad R=\frac{\left( n_T-n_1^2 \right)^2}{\left( n_T+n_1^2 \right)^2}
	\label{eq:coolres.arc}
\end{equation}
Now, we have a constraint on $n_1$, i.e. the composition of the layer. In order to have $0$ reflectance at the chosen frequency $\lambda$ we must find a material such that
\begin{equation}
	n_1=\sqrt{n_T}
	\label{eq:materialconstraint.arc}
\end{equation}
In common use for real-world application, like antireflecting glasses (i.e. $n_T\approx1.5$), is magnesium fluoride, where $n_{MgF_2}=n_1\approx1.35$. This combination doesn't respect precisely the previous constraint, but permits a reduction of the reflectance of the glasses by $99\%$. For negating completely the reflection of a chosen wavelength, multiple layers are used, where specifically they're alternated high-low reflectance films thick $\lambda/4$, with only 3 layers it's possible to block 3 different wavelengths. CHECK PROPERLY, I wrote $\lambda/4$ and not $\lambda_0/4$! It's not an error, the thickness depends directly on the material and its composition, since it also changes the refraction index, and therefore $\lambda$ \textit{will} differ.
\subsection{High Reflectance Films}
The opposite result of what we got with antireflecting films, is that of high-reflectance films, special films built by alternating layers thick $l=\lambda/4$ of high and low refracting indexes.\\
Said $n_H$ the refraction index of the highly refracting material and $n_L$ the refraction index of the low-refracting material (obviously $n_H>n_L$) we have, since they're thick exactly $\lambda/4$, that the transfer matrix of such system is
\begin{equation}
	\left( M_{H/L} \right)^i_j=\begin{pmatrix}
		0&-\frac{i}{n_{H/L}}\\
		-in_{H/L}&0
	\end{pmatrix}
	\label{eq:hltransmatrix.hrf}
\end{equation}
For the first high-low couple of layers the transfer matrix is simply the product of the two
\begin{equation*}
	\left( M_{HL} \right)^i_j=\begin{pmatrix}
		0&-\frac{i}{n_L}\\
		-in_L&0
	\end{pmatrix}\begin{pmatrix}
		0&-\frac{i}{n_H}\\
		-in_H&0
	\end{pmatrix}=\begin{pmatrix}
		-\frac{n_H}{n_L}&0\\
		0&-\frac{n_L}{n_H}
	\end{pmatrix}
\end{equation*}
Alternating $2N$ stacks of high-low reflectance layer, the transfer matrix is found simply using matrix powers, i.e.
\begin{equation}
	M^i_j=\left( M_{HL}^N \right)^i_j=\left( -1 \right)^N\begin{pmatrix}
		\left( n_H/n_L \right)^N&0\\
		0&\left( n_L/n_H \right)^N
	\end{pmatrix}
	\label{eq:hrftrans.hrf}
\end{equation}
From \eqref{eq:rcoeff.mlt} then, we have that the reflection coefficient for a high-reflectance film is, supposed for ease of calculation $n_0=n_T=1$
\begin{equation}
	r=\frac{\left( \frac{n_H}{n_L} \right)^N-\left( \frac{n_L}{n_H} \right)^N}{\left( \frac{n_H}{n_L} \right)^N+\left( \frac{n_L}{n_H} \right)^N}
	\label{eq:rcoeff.hrf}
\end{equation}
Which gives a reflectance of
\begin{equation}
	R=\frac{\left( n_H^{2N}-n_L^{2N} \right)^2}{\left( n_H^{2N}+n_L^{2N} \right)}
	\label{eq:reflect.hrf}
\end{equation}
The reflectance clearly goes to unity with $N\to\infty$, i.e., the more stacks we put the more the film reflects a specific frequency. In the case of layers of zinc sulfide ($\mathrm{ZnS}$, $n_H=2.3$) and magnesium fluoride ($\mathrm{MgF_2}$, $n_L=1.35$), with a stack of 8 layers (4 layers of each, or 4 couples of high-low layers), the reflectance is $R\simeq0.97$, which is higher than that of silver, in the visible range. A stack of 30 layers gives $R\gtrsim0.999$. The highly-reflected wavelenght band can be broadened by the simple combination of multiple thicknesses of the layers
\end{document}
